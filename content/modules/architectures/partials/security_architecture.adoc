
.Security Architecture
[ditaa,security_architecture,png]
....
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                 |
|                                                                   /--------------------\                                   /--------------------------------------------------\ |
| /==========\ Request  /----------\ Request  /----------\ Request  |               cDEF |                                   |                Authenticating Realms             | |
| | External |--------->|          |--------->|  Jetty   |--------->|      Web SSO       |                                   |   /----------\   /----------\   /----------\     | |
| |   DDF    |          |  Jetty   |          |  Auth.   |          |      Filter        |                             /---->|==>|  Guest   |==>|   Oidc   |==>|   SAML   |==\  | |
| |  Client  |          |          |<---------|     cEEE |<---------|                    |                             |     |   |  Realm   |   |   Realm  |   |   Realm  |  :  | |
| \==========/          \----------/ Response \----------/ Response |  /------------\    |                             |     |   \----------/   \----------/   \----------/  :  | |
|      ^                     |                                      |  |Whitelisted?|<---|--------\                    |     |                                               :  | |
|      |                     | Response        /-----------\        |  \------------/    |        |        /-----------+ /---|===============================================/  | |
|      |                     |                 |c5F5       |  Yes   |    :    :          |        v        |Auth. Token| |   |                                             cDEF | |
|      |       /-------------+------------\    |  Endpoint |<-------|====/    :No        |     /=======\   \-----------+ |   \--------------------------------------------------/ |
|      |       |             |            |    \-----------/        |         :        /-|---->|Web Ctx|               | |                                                        |
|      |       v             v            v                         |         :        | |     |Policy |               | |                                                        |
|      | /-----------\  /--------\  /-----------\                   |         :        | |  /->|Manager|               | +-------\                                                |
|      | |   c5F5    |  | cF55   |  | cF55      | /-----------\     |         :        | |  |  \=======/               | |Subject|                                                |
|      \-|  Endpoint |  |  Not   |  |    Not    | |Basic Auth.|<-\  |         v        | |  |  /---------\   /-------\ | +-------/                                                |
|        |           |  |Handled |  | Authorized| |  Handler  |  |  |  /------------\  | |  |  |    cDEF |   | Shiro | | |                                                        |
|        \-----------/  \--------/  \-----------/ \-----------/  \--|--|loop through|<-/ |  |  |         |   |       | | |                                                        |
|                                                       |           |  | configured |    |  |  |         |-->|======>|-/ |                                                        |
|                                                       v        /--|->|  handlers  |    |  |  |  Login  |   |       |   |                                                        |
|                                                 /-----------\  |  |  \------------/    |  |  |  Filter |   |       |   |                                                        |
|                                                 |PKI Handler|  |  |        :           |  |  |         |<--|<======|<--/                                                        |
|                                                 \-----------/  |  |        \==========>|--|->|         |   |       |                                                            |
|                                                       |        |  |                    |  |  |         |   |       |                                                            |
|                                                       v        |  \--------------------/  |  |         |   |       |                                                            |
|                                                 /-----------\  |                          |  \---------/   |       |                                                            |
|                                                 |   SAML    |  |                          |       |        |       |                                                            |
|                                                 |  Handler  |  |                          |       |        |       |                                                            |
|                                                 \-----------/  |                          |       v        |       |                        /==========\                        |
|                                                       |        |                          |  /---------\   |       |                        |          |                        |
|                                                       v        |                          |  |     cDEF|   |       |                    /-->| Expansion|                        |
|                                                 /-----------\  |                          |  |         |   |       |                    |   |  Service |                        |
|                                                 |   OAuth   |  |                          |  |         |   |       |       /----------\ | /-|          |                        |
|                                                 |  Handler  |  |                          \->|         |-->|======>|------>|          |-/ | \==========/                        |
|                                                 \-----------/  |                             |  Authz  |   |       |       |  Authz   |<--/                                     |
|                                                       |        |                             |  Filter |   |       |       |  Realm   |                                         |
|                                                       v        |                             |         |   |       |       |          |<--\                                     |
|                                                 /-----------\  |                             |         |<--|<======|<------|    cDEF  |-\ | /==========\                        |
|                                                 |   OIDC    |  |                             |         |   |       |       \----------/ | \-|          |                        |
|                                                 |  Handler  |  |                             |         |   |  c555 |                    |   |   PDP    |                        |
|                                                 \-----------/  |                             \---------/   \-------/                    \-->|          |                        |
|                                                       |        |                                                                            \==========/                        |
|                                                       \--------/                                                                                                                |
|                                                                                                                                                                                 |
+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
....
