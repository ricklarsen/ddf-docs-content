SAML IdP Architecture
[ditaa,security_idp_architecture,png]
....
+---------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                       Metadata Exchange                               |
|                                                      /---------------------------------------------------------------------------\    |
|                                                      |                                                                           |    |
|                                                      v                                                                           |    |
|  +--------------+         +--------------------------+-------+       +-------------+                                             |    |
|  |              |         |                                  |       |             |                                             |    |
|  |   Web SSO    +----+    |   SAML Client                    |       |  Endpoint   |                                             |    |
|  |   Filter     |    |    |                                  |       |             |                                             |    |
|  |              |    |    |                                  |       |c5F5         |                                             |    |
|  +--------------+    |    +-----------------+----------------+       +------+------+                                             |    |
|         ^            |    |   IdP Handler   |   Assertion    |              ^                                                    |    |
|         |            \--->+ cDEF            |   Consumer     |              |                                                    |    |
|         |    Yes          |  +------------+ |   Service (ACS)|              |                                                    |    |
|         \-----------------|--+  Has SAML  | |                |  Logged In   |                                                    |    |
|                           |  |            | |                +--------------/                                                    |    |
|                           |  +-------+----+ |                |                                                                   |    |
|                           |          | No   |                |                                                                   |    |
|                           |          v      |                |                                                                   |    |
|                           |  +-------+----+ |                |                         +---------+----------+--------------+     |    |
|                      Yes  |  | Is Broswer | |                | Redirect back via POST  |                    |   Metadata   |     |    |
|                   /-------|--+            | |                |<------------------------+                    |   Endpoint   +<----/    |
|                   |       |  +-------+----+ |                |                         |      SAML Server   |cDEF          |          |
|                   |       |          | No   |                |              /--------->|                    +--------------+          |
|                   |       |          v      |                |              |          |                                   |          |
|                   |       |  +------------+ |                |              |          |                                   |          |
|                   |       |  | Start ECP  | |                |              |          |                                   |          |
|                   |       |  | c5F5       | |                |              |          +-----------------------------------+          |
|                   |       |  +------------+ |cDEF            |              |                                                         |
|                   |       +-----------------+----------------+              |                                                         |
|                   |                   Redirect to IdP                       |                                                         |
|                   \---------------------------------------------------------/                                                         |
+---------------------------------------------------------------------------------------------------------------------------------------+

....
